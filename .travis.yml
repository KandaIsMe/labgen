language: cpp

env:
  - OPENCV_VERSION=2
  - OPENCV_VERSION=3

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get update -qq; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -qq libopencv-dev; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -qq libboost-program-options-dev; fi

  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then /usr/bin/yes | pip uninstall numpy; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew tap homebrew/science; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" && "$OPENCV_VERSION" == "2" ]]; then brew install opencv; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" && "$OPENCV_VERSION" == "3" ]]; then brew install opencv3; fi

script:
  - cd build
  - cmake -DCMAKE_BUILD_TYPE=Release ..
  - make

matrix:
  include:
    - dist: trusty
      compiler: g++
      env: OPENCV_VERSION=2

    - os: osx
      compiler: clang++
      env: OPENCV_VERSION=2

    - os: osx
      compiler: clang++
      env: OPENCV_VERSION=3
